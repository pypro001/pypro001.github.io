PRACTICAL 6
IMPLEMENT THE FOLLOWING EJB 
APPLICATIONS

PART A
AIM: Create a Currency Converter application using EJB.
index.html:
<!DOCTYPE html>
<html>
 <head>
 <title>Currency converter</title>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 </head>
 <body>
 <center>
 <form action="CCServlet">
 Enter amount:<input type="text" name="amt"><br><br>
 Select conversion type:<input type="radio" name="type" value="r2d" checked="">
 Rupees to Dollar:<input type="radio" name="type" value="d2r">
 Dollar to Rupees<br><br><br>
 <input type="reset">
 <input type="submit" value="CONVERT"><br><br>
 </form>
 </center>
 </body>
</html>
CCServlet.java:
package mypack;
import java.io.IOException;
import java.io.PrintWriter;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.ejb.EJB;
import mybeans.CCBean; //We are importing the bean that we have created. The format is <packagename
>.<beanclassname>
public class CCServlet extends HttpServlet {
 @EJB CCBean obj;
 @Override
 protected void service(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
 response.setContentType("text/html;charset=UTF-8");
 PrintWriter out=response.getWriter();
 double amt=Double.parseDouble(request.getParameter("amt"));
 if(request.getParameter("type").equals("r2d")){
 out.println("<h1>"+amt+"Rupees="+obj.r2Dollor(amt)+"Dollars</h1>");
 }
 if(request.getParameter("type").equals("d2r")){
 out.println("<h1>"+amt+"Dollars="+obj.d2Rupees(amt)+"Rupees</h1>");
 }
 }
}
CCBean.java:
package mybeans;
import jakarta.ejb.Stateless;
@Stateless
public class CCBean {
 public double r2Dollor(double r){
 return r/79.97;
 }
 public double d2Rupees(double d){
 return d*79.97;
 }
}

PART B
AIM: Develop a Simple Room Reservation System 
Application Using EJB.
index.html:
<!DOCTYPE html>
<html>
 <head>
 <title>Room booking demo</title>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 </head>
 <body>
 <form action="RServlet">
 Select a room type<br>
 <input type="radio" name="txtType" value="Delux">Deluxe<br>
 <input type="radio" name="txtType" value="Super Delux">Super Deluxe<br>
 <input type="radio" name="txtType" value="Suit">Suite<br>
 Enter your name : <input type="text" name="txtCust"><br>
 Enter mobile number : <input type="text" name="txtMob"><br>
 <input type="reset">
 <input type="submit" value="Book Room">
 </form>
 </body>
</html>
RServlet.java:
package demoR;
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.ejb.EJB;
import mybean.RoomRBean;
public class RServlet extends HttpServlet {
 @EJB RoomRBean obj;
 @Override
 protected void service(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
 response.setContentType("text/html;charset=UTF-8");
 PrintWriter out = response.getWriter();
 String rtype=request.getParameter("txtType");
 String custn=request.getParameter("txtCust");
 String custm=request.getParameter("txtMob");
 String msg=obj.roomBook(rtype, custn, custm);
 out.println(msg);
 }
}
RoomRBean.java:
package mybean;
import javax.ejb.Stateless;
import java.sql.*;
@Stateless
public class RoomRBean {
 public String roomBook(String rt, String cn, String cm) {
 String msg = "";
 try {
 Class.forName("com.mysql.jdbc.Driver");
 Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/HotelMgmt", "root
", "Basilkutty*2k3");
 String query = "select * from roomDetails where RoomType=? and status='Not Booked'";
 PreparedStatement pst = con.prepareStatement(query);
 pst.setString(1, rt);
 ResultSet rs = pst.executeQuery();
 if (rs.next()) {
 String rno = rs.getString(1);
 PreparedStatement stm1 = con.prepareStatement("update roomDetails set cust=? where RoomI
d=?");
 PreparedStatement stm2 = con.prepareStatement("update roomDetails set mob=? where RoomI
d=?");
 PreparedStatement stm3 = con.prepareStatement("update roomDetails set status=? where Room
Id=?");
 stm1.setString(1, cn);
 stm1.setString(2, rno);
 stm2.setString(1, cm);
 stm2.setString(2, rno);
 stm3.setString(1, "Booked");
 stm3.setString(2, rno);
 stm1.executeUpdate();
 stm2.executeUpdate();
 stm3.executeUpdate();
 msg = "Room " + rno + " booked <br> charges = " + rs.getString(3);
 } else {
 msg = "Room " + rt + " currently Not available";
 }
 } catch (Exception e) {
 System.out.println(e);
 }
 return msg;
 }
}

