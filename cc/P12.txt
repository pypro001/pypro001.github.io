PRACTICAL 12
PROGRAMMING NETWORK COMMUNICATIONS AND SERVICES (JSON)
AIM : To demonstrate Network Communications and Services (JSON) in Android.
PROGRAM :
getInfo.php
<?php
$host = "localhost";
$user_name = "root";
$password = "root";
$db_name="user_db";
$conn=mysqli_connect($host, $user_name, $password, $db_name);
$sql="SELECT * FROM user_info WHERE name LIKE 'john';";
$result=mysqli_query($conn, $sql);
if(mysqli_num_rows($result)>0){
$row=mysqli_fetch_assoc($result);
echo json_encode(array("Name"=>$row["name"], "E-mail"=>$row["email"], "Mobile"=>$row["mobile"]));
}
?>
MySingleton.java
package com.sonic.pract_13;
import android.content.Context;
import com.android.volley.Request;
import com.android.volley.RequestQueue;
import com.android.volley.toolbox.Volley;
public class MySingleton {
private static MySingleton mySingleton;
private RequestQueue requestQueue;
private static Context mctx;
public MySingleton(Context context){
mctx=context;
requestQueue=getRequestQueue();
}

public RequestQueue getRequestQueue() { 
if (requestQueue==null){ 
requestQueue=Volley.newRequestQueue(mctx.getApplicationContext()); 
} 
return requestQueue; 
} 
public static synchronized MySingleton getInstance(Context context){ 
if(mySingleton==null){ 
mySingleton=new MySingleton(context); 
} 
return mySingleton; 
} 
public <T>void addToRequest(Request<T> request){ 
requestQueue.add(request); 
} 
} 

MainActivity.java 
package com.sonic.pract_13; 
import androidx.appcompat.app.AppCompatActivity; 
import com.android.volley.Request; 
import com.android.volley.Response; 
import com.android.volley.VolleyError; 
import com.android.volley.toolbox.JsonObjectRequest; 
import org.jetbrains.annotations.TestOnly; 
import org.json.JSONObject; 
import android.os.Bundle; 
import android.view.View; 
import android.widget.Button; 
import android.widget.TextView; 
import android.widget.Toast; 
public class MainActivity extends AppCompatActivity { 
Button button; 
TextView tname, tmobile, temail; 
String Json_url="http://192.168.8.41/mysql_json/getInfo.php"; 
@Override 
protected void onCreate(Bundle savedInstanceState) { 
super.onCreate(savedInstanceState); 
setContentView(R.layout.activity_main); 
button=(Button) findViewById(R.id.btnShow); 
tname=(TextView) findViewById(R.id.name);
tmobile=(TextView) findViewById(R.id.mobile);
temail=(TextView) findViewById(R.id.email);
button.setOnClickListener(new View.OnClickListener() {
@Override
public void onClick(View v) {
JsonObjectRequest jsonObjectRequest=new JsonObjectRequest(Request.Method.POST, Json_url, (String) null, new Response.Listener<JSONObject>() {
@Override
public void onResponse(JSONObject response) {
try {
tname.setText("Name : " + response.getString("Name"));
temail.setText("E-mail :" + response.getString("E-mail"));
tmobile.setText("Mobile : " + response.getString("Mobile"));
} catch (Exception e) {
e.printStackTrace();
}
}
}, new Response.ErrorListener() {
@Override
public void onErrorResponse(VolleyError error) {
Toast.makeText(getApplicationContext(), "error", Toast.LENGTH_LONG).show();
}
});
MySingleton.getInstance(MainActivity.this).addToRequest(jsonObjectRequest);
}
});
}
}

